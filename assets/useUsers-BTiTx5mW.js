import{t as M,w as W,a as $,i as H,b as B,n as K,c as q,e as G,f as Q,p as X,g as Y}from"./useProjects-Cvj9AkYI.js";import{r as O,A as U,e as Z,L as k,M as ee,n as I,u as L}from"./index-XUP8zTlG.js";import{s as C}from"./utils-Blx_SZM_.js";function te(e){var t;const n=M(e);return(t=n==null?void 0:n.$el)!=null?t:n}const x=B?window:void 0;function F(...e){let t,n,s,u;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,s,u]=e,t=x):[t,n,s,u]=e,!t)return K;Array.isArray(n)||(n=[n]),Array.isArray(s)||(s=[s]);const a=[],o=()=>{a.forEach(f=>f()),a.length=0},p=(f,c,v,l)=>(f.addEventListener(c,v,l),()=>f.removeEventListener(c,v,l)),i=U(()=>[te(t),M(u)],([f,c])=>{if(o(),!f)return;const v=q(c)?{...c}:c;a.push(...n.flatMap(l=>s.map(_=>p(f,l,_,v))))},{immediate:!0,flush:"post"}),m=()=>{i(),o()};return G(m),m}function ne(e){return JSON.parse(JSON.stringify(e))}const D=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},J="__vueuse_ssr_handlers__",re=ae();function ae(){return J in D||(D[J]=D[J]||{}),D[J]}function se(e,t){return re[e]||t}function ie(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const oe={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},P="vueuse-storage";function le(e,t,n,s={}){var u;const{flush:a="pre",deep:o=!0,listenToStorageChanges:p=!0,writeDefaults:i=!0,mergeDefaults:m=!1,shallow:f,window:c=x,eventFilter:v,onError:l=r=>{console.error(r)},initOnMounted:_}=s,w=(f?k:O)(t);if(!n)try{n=se("getDefaultStorage",()=>{var r;return(r=x)==null?void 0:r.localStorage})()}catch(r){l(r)}if(!n)return w;const y=M(t),j=ie(y),S=(u=s.serializer)!=null?u:oe[j],{pause:g,resume:A}=W(w,()=>E(w.value),{flush:a,deep:o,eventFilter:v});c&&p&&$(()=>{F(c,"storage",V),F(c,P,T),_&&V()}),_||V();function N(r,d){c&&c.dispatchEvent(new CustomEvent(P,{detail:{key:e,oldValue:r,newValue:d,storageArea:n}}))}function E(r){try{const d=n.getItem(e);if(r==null)N(d,null),n.removeItem(e);else{const h=S.write(r);d!==h&&(n.setItem(e,h),N(d,h))}}catch(d){l(d)}}function R(r){const d=r?r.newValue:n.getItem(e);if(d==null)return i&&y!=null&&n.setItem(e,S.write(y)),y;if(!r&&m){const h=S.read(d);return typeof m=="function"?m(h,y):j==="object"&&!Array.isArray(h)?{...y,...h}:h}else return typeof d!="string"?d:S.read(d)}function V(r){if(!(r&&r.storageArea!==n)){if(r&&r.key==null){w.value=y;return}if(!(r&&r.key!==e)){g();try{(r==null?void 0:r.newValue)!==S.write(w.value)&&(w.value=R(r))}catch(d){l(d)}finally{r?I(A):A()}}}}function T(r){V(r.detail)}return w}function he(e,t,n={}){const{window:s=x}=n;return le(e,t,s==null?void 0:s.localStorage,n)}function be(e,t,n,s={}){var u,a,o;const{clone:p=!1,passive:i=!1,eventName:m,deep:f=!1,defaultValue:c,shouldEmit:v}=s,l=ee(),_=n||(l==null?void 0:l.emit)||((u=l==null?void 0:l.$emit)==null?void 0:u.bind(l))||((o=(a=l==null?void 0:l.proxy)==null?void 0:a.$emit)==null?void 0:o.bind(l==null?void 0:l.proxy));let w=m;t||(t="modelValue"),w=w||`update:${t.toString()}`;const y=g=>p?typeof p=="function"?p(g):ne(g):g,j=()=>H(e[t])?y(e[t]):c,S=g=>{v?v(g)&&_(w,g):_(w,g)};if(i){const g=j(),A=O(g);let N=!1;return U(()=>e[t],E=>{N||(N=!0,A.value=y(E),I(()=>N=!1))}),U(A,E=>{!N&&(E!==e[t]||f)&&S(E)},{deep:f}),A}else return Z({get(){return j()},set(g){S(g)}})}const b=Q,ue=e=>X.filter(t=>t.team.includes(Number(e))).map(t=>({...t,project_owner:b.find(n=>n.id===t.project_owner),team:t.team.map(n=>b.find(s=>s.id===n)),status:t.status})),z=(e,t)=>t==="projects"?e.projects.map(n=>n.project_name).join(", "):e[t],ce=async e=>{await C(1e3);const{isActive:t,search:n,sortBy:s,sortingOrder:u}=e;let a=b;a=a.filter(i=>i.active===t),n&&(a=a.filter(i=>i.fullname.toLowerCase().includes(n.toLowerCase()))),a=a.map(i=>({...i,projects:ue(i.id)})),s&&u&&(a=a.sort((i,m)=>{const f=z(i,s),c=z(m,s);return f>c?u==="asc"?1:-1:f<c?u==="asc"?-1:1:0}));const{page:o=1,perPage:p=10}=e||{};return{data:a.slice((o-1)*p,o*p),pagination:{page:o,perPage:p,total:a.length}}},fe=async e=>{await C(1e3),b.unshift(e)},de=async e=>{await C(1e3);const t=b.findIndex(n=>n.id===e.id);b[t]=e},pe=async e=>{await C(1e3),b.splice(b.findIndex(t=>t.id===e.id),1)},ge=()=>O({page:1,perPage:10,total:0}),me=()=>O({sortBy:"fullname",sortingOrder:null}),we=()=>O({isActive:!0,search:""}),_e=e=>{const t=O(!1),n=O([]),{filters:s=we(),sorting:u=me(),pagination:a=ge()}=e||{},o=async()=>{t.value=!0;const{data:i,pagination:m}=await ce({...L(s),...L(u),...L(a)});n.value=i,p(()=>{a.value=m}),t.value=!1},{ignoreUpdates:p}=Y([a,u],o,{deep:!0});return U(s,()=>{a.value.page=1,o()},{deep:!0}),o(),{isLoading:t,filters:s,sorting:u,pagination:a,users:n,fetch:o,async add(i){t.value=!0,await fe(i),await o(),t.value=!1},async update(i){t.value=!0,await de(i),await o(),t.value=!1},async remove(i){t.value=!0,await pe(i),await o(),t.value=!1}}};export{_e as a,he as b,be as u};
//# sourceMappingURL=useUsers-BTiTx5mW.js.map
